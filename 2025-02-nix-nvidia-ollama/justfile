#!/usr/bin/env -S just --justfile

## repo configuration
sub-update:
  cd .. && git submodule update --init --recursive

## nix installation

## nix updates
hostname := `hostname | cut -d "." -f 1`
[linux]
switch target_host=hostname:
  cd nix && NIXPKGS_ALLOW_UNFREE=1 sudo nixos-rebuild switch --flake .#{{target_host}} --impure

## copy docker compose yaml to remote host via Ansible
compose HOST *V:
  ansible-playbook playbook.yaml --limit {{HOST}} --tags compose {{V}}
